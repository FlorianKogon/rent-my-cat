<div class="container">
  <div id="carousel" class="carousel slide mb-4" data-ride="carousel">
    <div class="carousel-inner carousel-cat" >
      <div class="carousel-item active">
        <%= cl_image_tag @booking.cat.photo, class:"d-block w-100" %>
      </div>
      <div class="carousel-item">
        <%= cl_image_tag @booking.cat.photo, class:"d-block w-100" %>
      </div>
    </div>
    <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>

  <h1>Booking of <%= @booking.cat.name %> <i class="fas fa-cat"></i></h1>
  <hr>

  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <p><strong><ins>From <%= @booking.starting_date %> to <%= @booking.ending_date %></ins></strong> <br>
      <em>
        <% if @booking.cat.breed == 'Male' %>
          <i class="fas fa-mars"></i>
        <% else %>
          <i class="fas fa-venus"></i>
        <% end %>
        <%= @booking.cat.breed %> <br>
        <%= @booking.cat.address %> - <%= @booking.cat.age %> years old
      </em></p>

      <%= link_to cat_path(@booking.cat), class:'btn btn-outline-dark mt-3' do %>
        <i class="fas fa-paw"></i> <%= @booking.cat.name %>
      <% end %>
      <%= link_to user_path(User.find(@booking.cat.user_id)), class:'btn btn-outline-dark mt-3' do %>
        <i class="fas fa-user"></i> <%= User.find(@booking.cat.user_id).first_name %>
      <% end %>
    </div>

    <div class="d-flex align-items-end">
      <div class="d-flex flex-column card-infos">
        <div class="d-flex flex-column">
          <div class="d-flex justify-content-between">
            <div><%= @booking.cat.price_per_day %>€ x <%= (@booking.ending_date - @booking.starting_date).to_i %> days</div>
            <div><%=  sprintf('%.2f', (@booking.cat.price_per_day * (@booking.ending_date - @booking.starting_date)).to_i) %>€</div>
          </div>
          <div class="d-flex justify-content-between">
            <div>Service fees</div>
            <div><%= sprintf('%.2f', @booking.cat.price_per_day * 0.05) %>€</div>
        </div>
        <hr class="m-1 mt-4">
        <h2 class="px-4">Total: <%= sprintf('%.2f', @booking.total_price + @booking.cat.price_per_day * 0.05) %>€</h2>
      </div>

        <div class="text-center mt-4">
          <% if current_user.id != @booking.cat.user_id %>
            <%= link_to 'Cancel this booking', booking_path(@booking), method:'delete', class:'btn btn-dark ml-3' %>
            <%= link_to "Chat with #{User.find(@booking.cat.user_id).first_name}", new_chat_room_path, method:'get', class:'btn btn-dark ml-3' %>
            <%= link_to 'Accept', accept_booking_path(@booking), method:'patch', class:'btn btn-primary ml-3' %>
            <%= link_to 'Refuse', refuse_booking_path(@booking), method:'patch', class:'btn btn-dark ml-3' %>
          <% elsif current_user.id = @booking.cat.user_id && @booking.status == "accepted" %>
            <%= link_to 'Cancel this booking', booking_path(@booking), method:'delete', class:'btn btn-dark ml-3' %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  <p class="alert-light p-2 w-100 rounded text-center"><strong>Status</strong> <%= @booking.status %></p>
</div>
